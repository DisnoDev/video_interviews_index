/* =========================
   Base theme vars
   ========================= */

@keyframes changeBottom {
  0%   { --bottom: #ff5555; }
  25%  { --bottom: #55ff55; }
  50%  { --bottom: #5555ff; }
  75%  { --bottom: #ffff55; }
  100% { --bottom: #ff5555; }
}


:root {
  --bg:#0b0c0f; --panel:#14161a; --ink:#e7ebf3; --muted:#9aa3b2; --accent:#7dd3fc; --line:#333;
  --top:#ffffff;         /* default: light top */
  --bottom:#ff5555;      /* animated bottom */
    --accent: var(--bottom);  /* accent now follows bottom animation */
}

body.light {
  --bg:#fafafa; --panel:#ffffff; --ink:#111; --muted:#555; --line:#ccc;
  --top:#ffffff;
}

/* animated gradient support */
@property --bottom { syntax: '<color>'; inherits: true; initial-value: #ff5555; }
@property --top    { syntax: '<color>'; inherits: true; initial-value: #ffffff; }

html, body { height: 100%; }

body {
  padding: 8px;  margin: 0; position: relative; z-index: 0;
  background: transparent;
  font-size: 24px;
  font-family: Arial, system-ui, -apple-system, Segoe UI, Roboto, Ubuntu, Cantarell, 'Helvetica Neue', 'Noto Sans';
  color: var(--ink); line-height: 1.25; font-weight: 300;
}

body::before {
  content: ""; position: fixed; inset: 0; z-index: -1; pointer-events: none;
  background-image: linear-gradient(180deg, var(--top) 0%, var(--bottom) 100%);
  animation: changeBottom 40s infinite linear;
}

@media (prefers-reduced-motion: reduce) { body::before { animation: none; } }

/* =========================
   Header / toolbar
   ========================= */
.wrap { max-width: 1600px; margin: 32px; padding: 0 0; }
header { display:flex; align-items:center; justify-content:space-between; gap:16px; margin-bottom:12px; }
h1 { font-size:24px; margin:0; letter-spacing:.2px; font-weight:700; padding:0px 0; }
h1 a { color:var(--ink); text-decoration:none; }

.pill, .toggle, #themeToggle {
  font-size: 24px; padding:2px 8px; border-radius:999px; background-color:transparent;
  border:1px solid var(--line); color:var(--ink); cursor:pointer; text-decoration:none;
}
.pill{ color:var(--ink); }

.hint { color:var(--ink); margin-top:12px; font-size: 14px; }

.xlate-hint {
  display:inline-block; margin-left:.35em; width:.6em; height:.6em; line-height:.6em;
  border-radius:50%; background: var(--top); vertical-align: .1em;
}

/* Sticky toolbar */
.tbar-wrap { position: sticky; top: 0; z-index: 50; padding: 12px 0; backdrop-filter: blur(6px); }
.tbar {
  display:flex; align-items:center; justify-content:space-between; flex-wrap:wrap; gap:8px;
  background: color-mix(in oklab, rgba(0,0,0,0) 68%, transparent);
  border: 1px solid var(--line); border-radius: 12px; padding: 8px;
  box-shadow: 0 6px 18px rgba(0,0,0,.25);
}
.tbar .left, .tbar .right { display:flex; align-items:center; gap:8px; flex-wrap:wrap; }
.toggle { color:var(--ink); font-size:24px; }
.toggle.active { background:rgba(122,122,122,.27); color:var(--ink); border-color:var(--bottom); }
#search{ width: 130px; background-color: transparent; border:1px solid var(--line); color:var(--ink); padding:8px 8px; border-radius:8px; outline:none }

/* =========================
   Table
   ========================= */
.table-wrap{
  background-color: transparent; border:0; border-radius:0;
  overflow:auto; position:relative; box-shadow:none; margin-top:24px;
}

#videoTable { border-collapse: separate; border-spacing: 24px 0; margin-left: -24px; margin-right: -24px; }
#videoTable th, #videoTable td { padding: 6px 0; text-align: left; white-space: nowrap; }

thead { position: static; background-color: transparent; z-index: 1; }
thead th{
  position: sticky; top: 0; z-index: 2;
  text-align:left; color:var(--ink); background-color: transparent;
}

tbody td { background-color: transparent; font-size: inherit; }
tbody tr { transition: background 120ms ease; cursor:pointer; }
tbody tr:hover { color: var(--bottom); }

th, td { padding: 0 0; border-spacing: 0; border-bottom:1px dashed var(--line); vertical-align:top; }

.sortable{ cursor:pointer; user-select:none; }
.sortable[data-sort-dir="asc"]::after  { content:" \25B2"; }
.sortable[data-sort-dir="desc"]::after { content:" \25BC"; }

/* keywords */
.col-keywords .kw-wrap {
  display: block; white-space: normal; overflow-wrap: anywhere;
  line-height: 0.7em; min-height: calc(0.7em * 2);
}
.kbtn {
  display: inline-block; font-size: 12px; text-transform: uppercase;
  padding: 3px 6px; margin: 1px; border-radius: 6px; border: 1px solid var(--line);
  background: transparent; color: var(--ink); cursor: pointer; line-height: 1.1; white-space: normal;
}
.tbtn {
  font-size: 16px; background: transparent; border: 0; display: inline-block; white-space: normal;
  padding: 0 3px; margin: 1px; border-radius: 6px;
}

.hover-card{
  backdrop-filter: blur(6px); color: var(--ink); position:fixed; pointer-events:none;
  width:360px; max-width:80vw; background: color-mix(in oklab, rgba(0,0,0,0) 68%, transparent);
  border:1px solid var(--line); border-radius:12px; box-shadow:0 12px 40px rgba(0,0,0,.5);
  padding:0; display:none; z-index:99;
}
.hover-card img{ width:100%; height:auto; display:block; border-radius:8px; }
.hover-card .meta{ padding:8px; color:var(--ink); margin-top:6px; }

/* left-compact table option */
.videoTable { width:auto; max-width:100%; table-layout:auto; border-collapse:collapse; }
.videoTable th, .videoTable td { text-align:left; white-space:nowrap; padding:0.3em 0.6em; vertical-align:top; }
.videoTable td { overflow-wrap:anywhere; word-break:break-word; white-space:normal; }
.videoTable tr { border-bottom: 1px solid #ddd; }
.table-container { display:flex; justify-content:flex-start; }

/* =========================
   Video modal (CLEAN STACK)
   ========================= */
.modal{
  position:fixed; inset:0; background:rgba(0,0,0,.7);
  display:none; align-items:center; justify-content:center; z-index:100;
}


.modal .close,.modal .fs{
  position:absolute; top:16px; background:var(--panel); border:1px solid var(--line); color:var(--ink);
  padding:8px 10px; border-radius:8px; cursor:pointer; z-index:101;
}
.modal .close{ right:20px; } .modal .fs{ left:20px; }

/* stack modal content vertically & center */
##modal.open { display:flex; flex-direction:column; align-items:center; gap:16px; }

/* shared width */
#modal .player-wrapper, #modal #audioScreen { width:min(92vw,960px); max-width:100%; }

/* VIDEO: responsive 16/9 box (.player) + iframe fills it */
/* one place only */
/* Video box */



/* Hide video in audio-only */
body.audio-mode .player { display:none; }



/* Audio-only â†’ expand transcript */
body.audio-mode #audioScreen { max-height:none; height:calc(100dvh - 140px); }

/* Optional: overlay used only in audio-only */
#aoOverlay { display:none; }
body.audio-mode #aoOverlay { display:block; }

/* Prevent hover preview from intercepting scroll in modal context */
#hoverCard { pointer-events:none; }

/* =========================
   Audio reading inner styles
   ========================= */
.audio-inner { width:min(900px, 90vw); display:flex; flex-direction:column; gap:12px; }
#audioTitle { margin:0; font-size: clamp(16px, 3vw, 24px); line-height:1.2; }
.audio-txt { flex:1; overflow:auto; font-size: clamp(18px, 3.2vw, 22px); line-height:1.5; letter-spacing:0.2px; padding-right:8px; }
.audio-txt p { margin: 0 0 0.9em 0; }
.audio-controls { display:flex; gap:14px; align-items:center; color:var(--muted); font-size:14px; }

/* =========================
   Misc
   ========================= */
#toggleAutoplay.active { border-color: var(--bottom); color: var(--ink); }
p { letter-spacing: 0.3px; }
.col-hidden{ display:none; }

/* Column visibility toggles */
[data-show-keywords="0"] .col-keywords { display:none; }
[data-show-transcript="0"] .col-transcript { display:none; }
[data-show-duration="0"] .col-duration,
[data-show-year="0"] .col-year,
[data-show-collection="0"] .col-collection,
[data-show-play="0"] .col-play { display:none; }

/* =========================
   Responsive
   ========================= */
@media (min-width: 900px){ .col-keywords { width: 26ch; } }

@media (max-width:700px){
  header, html, body, h1, tr, td, table, .modal, .hover-card { font-size: 16px !important; }
  .tbar { gap: 4px; flex-wrap: wrap-reverse; justify-content: flex-start !important; }
  #search { padding: 4px 4px; }
  .toggle2, #count, #toggleAutoplay, #exportPdfBtn, #pdfIncludeTranscript { visibility:hidden; display:none; }
  .tbar .right { width:100%; }
  .tbar, .tbar .left, .tbar .right { gap: 2px; }
  th,td{ padding:0; }
  .tbar, #themeToggle, .pill, .toggle, .wrap { font-size: 12px !important; }
  .hover-card{ display:none!important; }
}

/* MOBILE FIX PATCH */
@media (max-width: 768px) {
  #videoTable { width:100%; max-width:100vw; table-layout:fixed; border-collapse:collapse; border-spacing:0 !important; margin-left:0; margin-right:0; }
  #videoTable th, #videoTable td {
    min-width:0; white-space:normal !important; overflow-wrap:anywhere; word-break:break-word; padding:6px 0;
  }
  #videoTable tbody tr { border-bottom: 1px solid var(--line); padding: 0.4rem 0; }
} /* <-- closed properly */

/* DESKTOP COMPACT TABLE */
@media (min-width: 901px) {
  #videoTable { display:inline-table; width:auto; max-width:100%; table-layout:auto; border-collapse:collapse; border-spacing:0 !important; margin-left:0; margin-right:0; }
  #videoTable th, #videoTable td { text-align:left; white-space:nowrap; padding: 0 14px 0 0; vertical-align:top; }
  #videoTable tr > *:last-child { padding-right: 0; }
  #videoTable td { overflow-wrap:anywhere; word-break:break-word; }
  table { border-spacing: 0 !important; }
  #videoTable col { width: 1%; }
}
/* ====== PGTK HOTFIX (authoritative modal + player) ====== */

/* Modal visibility: hidden by default, visible only when .open */
#modal { display: none !important; }
.modal.open {
  display: flex !important;
  align-items: center;
  justify-content: center;
}

/* When open, stack vertically (video on top, transcript below) */
#modal.open {
  display: flex !important;
  flex-direction: column;
  gap: 16px;
  align-items: center;
  justify-content: center;
}

/* Video box (container owns 16:9); iframe fills it */
#modal .player {
  position: relative !important;
  width: min(92vw, 960px) !important;
  aspect-ratio: 16 / 9 !important;
  background: var(--panel) !important;
  border: 1px solid var(--line) !important;
  border-radius: 12px !important;
  overflow: hidden !important;
  margin: 0 auto !important;
  opacity: 1 !important;
}
#modal .player iframe#player {
  position: absolute !important;
  inset: 0 !important;
  width: 100% !important;
  height: 100% !important;
  display: block !important;
  border: 0 !important;
  border-radius: inherit !important;
  opacity: 1 !important;
  pointer-events: auto !important;
  z-index: 1 !important;
}

/* Transcript: normal block under the video (never overlay) */
#modal #audioScreen {
  position: relative !important;
  inset: auto !important;
  z-index: 0 !important;
  width: min(92vw, 960px) !important;
  margin: 16px auto 0 !important;
  padding: 16px !important;
  background: var(--panel) !important;
  border: 1px solid var(--line) !important;
  border-radius: 12px !important;
  box-sizing: border-box !important;
  max-height: 48vh !important;
  overflow: auto !important;
}

/* Audio-only: hide only the video; transcript expands */
body.audio-mode #modal .player { display: none !important; }
body.audio-mode #modal #audioScreen {
  max-height: none !important;
  height: calc(100dvh - 140px) !important;
}

/* Safety: the hover preview must not intercept scroll/clicks on modal */
#modal #hoverCard { pointer-events: none !important; }


/* modal visibility */
#modal { display: none !important; }
.modal.open { display: flex !important; align-items: center; justify-content: center; }
#modal.open { display: flex !important; flex-direction: column; gap: 16px; align-items: center; justify-content: center; }

/* 16:9 container + iframe fills it */
#modal .player { position: relative; width: min(92vw, 960px); aspect-ratio: 16/9;
  background: var(--panel); border: 1px solid var(--line); border-radius: 12px; overflow: hidden; margin: 0 auto; }
#modal .player iframe#player { position: absolute; inset: 0; width: 100%; height: 100%; display: block; border: 0; border-radius: inherit; }

/* transcript as normal block below video */
#modal #audioScreen { position: relative; width: min(92vw,960px); margin: 16px auto 0; padding: 16px;
  background: var(--panel); border: 1px solid var(--line); border-radius: 12px; box-sizing: border-box; max-height: 48vh; overflow: auto; }

/* audio-only still works */
body.audio-mode #modal .player { display: none; }
body.audio-mode #modal #audioScreen { max-height: none; height: calc(100dvh - 140px); }

